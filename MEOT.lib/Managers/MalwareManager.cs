using MEOT.lib.DAL.Base;
using MEOT.lib.Objects;

namespace MEOT.lib.Managers
{
    public class MalwareManager
    {
        private IDAL _db;

        public MalwareManager(IDAL db)
        {
            _db = db;
        }

        public void DeleteMalware(int id)
        {
            _db.DeleteById<Malware>(id); // Delete the root record

            // Delete associated records
            _db.DeleteWhere<MalwareCheckpoint>(a => a.MalwareId == id);

            _db.DeleteWhere<MalwareVendorCheckpoint>(a => a.MalwareId == id);
        }
    }
}