using System.Net.Http;
using System.Net.Http.Json;
using System.Threading.Tasks;

using MEOT.lib.Containers;
using MEOT.Web.Clients.Base;

namespace MEOT.Web.Clients
{
    public class MalwareAnalysisClient : BaseClient
    {
        protected MalwareAnalysisClient(HttpClient httpClient) : base(httpClient)
        {
        }

        public async Task<MalwareAnalysisContainer> GetAnalysisAsync(string query) => await http.GetFromJsonAsync<MalwareAnalysisContainer>(BuildURL($"MalwareAnalysis?query={query}"));
    }
}