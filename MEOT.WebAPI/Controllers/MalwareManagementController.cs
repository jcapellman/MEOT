using System;

using MEOT.lib.Managers;
using MEOT.lib.Objects;
using MEOT.lib.WebObjects;
using MEOT.WebAPI.Controllers.Base;

using Microsoft.AspNetCore.Mvc;

namespace MEOT.WebAPI.Controllers
{
    public class MalwareManagementController : BaseController
    {
        private MalwareManager _manager;

        public MalwareManagementController(MalwareManager manager)
        {
            _manager = manager;
        }

        [HttpPost]
        public bool Add(NewMalwareRequestItem item)
        {
            _manager.CreateOrUpdate(new Malware
            {
                Enabled = true,
                Name = item.Name,
                Created = DateTimeOffset.Now,
                SHA1 = item.SHA1,
                Modified = DateTimeOffset.Now,
                DayZero = DateTimeOffset.Now,
                Format = item.Format
            }, true);

            return true;
        }
    }
}