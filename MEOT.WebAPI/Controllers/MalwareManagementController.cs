using System;

using MEOT.lib.Managers;
using MEOT.lib.Objects;

using MEOT.WebAPI.Controllers.Base;

using Microsoft.AspNetCore.Mvc;

namespace MEOT.WebAPI.Controllers
{
    public class MalwareManagementController : BaseController
    {
        private MalwareManager _manager;

        public MalwareManagementController(MalwareManager manager)
        {
            _manager = manager;
        }

        [HttpGet("{sha1Hash}/{name}")]
        public bool Add(string sha1Hash, string name)
        {
            _manager.CreateOrUpdate(new Malware
            {
                Enabled = true,
                Name = name,
                Created = DateTimeOffset.Now,
                SHA1 = sha1Hash,
                Modified = DateTimeOffset.Now,
                DayZero = DateTimeOffset.Now,
                Format = null
            }, true);

            return true;
        }
    }
}